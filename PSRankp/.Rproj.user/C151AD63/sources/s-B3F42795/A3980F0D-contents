library("pROC")
library("matrixStats")
library("caTools")
library("snpStats")
library("ggplot2")
fam = "output/unif_Laplace_omni.fam"
bim = "output/unif_Laplace_omni.bim"
bed = "output/unif_Laplace_omni.bed"
dat = read.plink(bed, bim, fam)

frac = .5

res = PSRank(dat,
             frac=.5,
             ranking="beta")
# Write CSV in R
write.table(res, file = "res_AUC.csv",row.names=FALSE, col.names=FALSE, sep=",")
# Read CSV into R
MyData <- read.csv(file="res_AUC.csv", header=FALSE, sep=",")



# plot means
summary_res = as.data.frame(cbind(SNPs = 1:dim(res)[2],Means = colMeans(res),sd = colSds(res)))

ggplot(summary_res, aes(x=SNPs, y=Means)) +
  geom_line() +
  geom_point()+
  geom_errorbar(aes(ymin=Means-sd, ymax=Means+sd), width=.2,
                position=position_dodge(0.05))


